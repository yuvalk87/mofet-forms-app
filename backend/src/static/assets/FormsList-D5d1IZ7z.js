import{r as l,j as e}from"./index-D202YUUW.js";const f=({onFormSelect:d})=>{const[x,u]=l.useState([]),[h,m]=l.useState(!0),[r,o]=l.useState(null),[t,c]=l.useState("all");l.useEffect(()=>{g()},[t]);const g=async()=>{try{m(!0);let s="/api/forms";const a=new URLSearchParams;t==="my_forms"?a.append("my_forms_only","true"):t==="pending_for_me"&&a.append("pending_for_me","true"),a.toString()&&(s+="?"+a.toString());const n=await fetch(s,{credentials:"include"});if(n.ok){const i=await n.json();u(i.forms||[])}else o("שגיאה בטעינת הטפסים")}catch{o("שגיאה בחיבור לשרת")}finally{m(!1)}},j=s=>{const n={pending:{text:"ממתין לאישור",class:"bg-yellow-100 text-yellow-800"},approved:{text:"אושר",class:"bg-green-100 text-green-800"},rejected:{text:"נדחה",class:"bg-red-100 text-red-800"},completed:{text:"הושלם",class:"bg-blue-100 text-blue-800"},awaiting_final_approval:{text:"ממתין לאישור סופי",class:"bg-purple-100 text-purple-800"}}[s]||{text:s,class:"bg-gray-100 text-gray-800"};return e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${n.class}`,children:n.text})},p=s=>s?new Date(s).toLocaleDateString("he-IL",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"";return h?e.jsx("div",{className:"forms-background min-h-screen",children:e.jsx("div",{className:"p-8 space-y-8 relative z-10",children:e.jsx("div",{className:"icl-card animate-fade-in-up",children:e.jsxs("div",{className:"flex items-center justify-center py-16",children:[e.jsx("div",{className:"loading-spinner mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 mr-4",children:"טוען טפסים..."})]})})})}):e.jsx("div",{className:"forms-background min-h-screen",children:e.jsxs("div",{className:"p-8 space-y-8 relative z-10",children:[e.jsxs("div",{className:"icl-card animate-fade-in-up",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold gradient-text",children:"כל הטפסים"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"ניהול וצפייה בכל הטפסים במערכת"})]})}),e.jsxs("div",{className:"flex space-x-4 mb-6",children:[e.jsx("button",{onClick:()=>c("all"),className:`px-4 py-2 rounded-lg transition-all duration-300 ${t==="all"?"icl-primary-button":"icl-secondary-button"}`,children:"כל הטפסים"}),e.jsx("button",{onClick:()=>c("my_forms"),className:`px-4 py-2 rounded-lg transition-all duration-300 ${t==="my_forms"?"icl-primary-button":"icl-secondary-button"}`,children:"הטפסים שלי"}),e.jsx("button",{onClick:()=>c("pending_for_me"),className:`px-4 py-2 rounded-lg transition-all duration-300 ${t==="pending_for_me"?"icl-primary-button":"icl-secondary-button"}`,children:"ממתינים לאישור שלי"})]})]}),r&&e.jsx("div",{className:"icl-card animate-fade-in-up",children:e.jsx("div",{className:"bg-red-50 border-2 border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-red-500 text-xl ml-3",children:"⚠️"}),e.jsx("p",{className:"text-red-800 font-medium",children:r})]})})}),x.length===0&&!r?e.jsxs("div",{className:"icl-card text-center py-16 animate-fade-in-up animate-delay-200",children:[e.jsx("div",{className:"text-6xl mb-4",children:"📋"}),e.jsx("div",{className:"text-gray-500 text-xl mb-6",children:t==="my_forms"?"אין לך טפסים במערכת":t==="pending_for_me"?"אין טפסים הממתינים לאישור שלך":"אין טפסים במערכת"})]}):e.jsx("div",{className:"space-y-4",children:x.map((s,a)=>e.jsx("div",{className:"icl-card icl-card-enhanced animate-fade-in-up cursor-pointer",style:{animationDelay:`${a*.1}s`},onClick:()=>d&&d(s),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:s.template_name||`טופס #${s.id}`}),j(s.status)]}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"יוצר הטופס:"})," ",s.initiator_name]}),e.jsxs("p",{children:[e.jsx("strong",{children:"תאריך יצירה:"})," ",p(s.created_at)]}),s.completed_at&&e.jsxs("p",{children:[e.jsx("strong",{children:"תאריך השלמה:"})," ",p(s.completed_at)]})]}),s.form_data&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"פרטי הטופס:"}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[Object.entries(s.form_data).slice(0,3).map(([n,i])=>e.jsxs("p",{children:[e.jsxs("strong",{children:[n,":"]})," ",typeof i=="string"?i:JSON.stringify(i)]},n)),Object.keys(s.form_data).length>3&&e.jsxs("p",{className:"text-gray-500",children:["ועוד ",Object.keys(s.form_data).length-3," שדות..."]})]})]})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-2xl mb-2",children:s.status==="completed"?"✅":s.status==="rejected"?"❌":s.status==="pending"?"⏳":s.status==="awaiting_final_approval"?"🔄":"📋"}),e.jsxs("div",{className:"text-xs text-gray-500",children:["שלב ",s.current_step+1]})]})]})},s.id))})]})})};export{f as default};
