import{r as o,j as e}from"./index-CKU2iVDY.js";const w=()=>{const[a,i]=o.useState(""),[s,d]=o.useState({}),[v,p]=o.useState([]),[u,b]=o.useState(!1),[g,n]=o.useState(null),[f,c]=o.useState(!1);o.useEffect(()=>{h()},[]);const h=async()=>{try{const r=await fetch("/api/forms/templates",{credentials:"include"});if(r.ok){const l=await r.json();p(l.templates||[])}}catch(r){console.error("Error fetching templates:",r)}},m=r=>{i(r),d({}),n(null),c(!1)},t=(r,l)=>{d(x=>({...x,[r]:l}))},y=async r=>{r.preventDefault(),b(!0),n(null);try{const l=await fetch("/api/forms/",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({template_type:a,form_data:s})}),x=await l.json();l.ok?(c(!0),d({}),i(""),setTimeout(()=>{window.location.href="/forms"},2e3)):n(x.error||"שגיאה ביצירת הטופס")}catch(l){n("שגיאה בחיבור לשרת"),console.error("Submit error:",l)}finally{b(!1)}},j=()=>{switch(a){case"SMS":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"תאריך"}),e.jsx("input",{type:"date",value:s.date||"",onChange:r=>t("date",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"מתקן"}),e.jsx("input",{type:"text",value:s.facility||"",onChange:r=>t("facility",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"נושא"}),e.jsx("input",{type:"text",value:s.subject||"",onChange:r=>t("subject",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"שם הודעה"}),e.jsx("input",{type:"text",value:s.message_name||"",onChange:r=>t("message_name",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"נמענים"}),e.jsx("textarea",{value:s.recipients||"",onChange:r=>t("recipients",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:"רשימת נמענים...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"תנאים"}),e.jsx("textarea",{value:s.conditions||"",onChange:r=>t("conditions",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",placeholder:"תנאים מיוחדים (אופציונלי)..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"שם תג"}),e.jsx("input",{type:"text",value:s.tag_name||"",onChange:r=>t("tag_name",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]});case"תוכנה":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"שם התוכנה"}),e.jsx("input",{type:"text",value:s.software_name||"",onChange:r=>t("software_name",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"גרסה"}),e.jsx("input",{type:"text",value:s.version||"",onChange:r=>t("version",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"תיאור"}),e.jsx("textarea",{value:s.description||"",onChange:r=>t("description",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"4",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"מטרת השימוש"}),e.jsx("textarea",{value:s.purpose||"",onChange:r=>t("purpose",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",required:!0})]})]});case"תגים":return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"סוג תג"}),e.jsxs("select",{value:s.tag_type||"",onChange:r=>t("tag_type",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"בחר סוג תג"}),e.jsx("option",{value:"זיהוי",children:"תג זיהוי"}),e.jsx("option",{value:"גישה",children:"תג גישה"}),e.jsx("option",{value:"חניה",children:"תג חניה"}),e.jsx("option",{value:"אחר",children:"אחר"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"כמות"}),e.jsx("input",{type:"number",min:"1",value:s.quantity||"",onChange:r=>t("quantity",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"מטרת השימוש"}),e.jsx("textarea",{value:s.purpose||"",onChange:r=>t("purpose",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"3",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"הערות"}),e.jsx("textarea",{value:s.notes||"",onChange:r=>t("notes",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:"2"})]})]});default:return null}};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"יצירת טופס חדש"}),g&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:g})}),f&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsx("p",{className:"text-green-800",children:"הטופס נוצר בהצלחה! מעביר לרשימת הטפסים..."})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("label",{className:"block text-lg font-medium text-gray-900 mb-4",children:"בחר סוג טופס:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{type:"button",onClick:()=>m("SMS"),className:`p-4 rounded-lg border-2 transition-colors ${a==="SMS"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-700"}`,children:[e.jsx("div",{className:"text-2xl mb-2",children:"📱"}),e.jsx("div",{className:"font-semibold",children:"בקשת SMS"})]}),e.jsxs("button",{type:"button",onClick:()=>m("תוכנה"),className:`p-4 rounded-lg border-2 transition-colors ${a==="תוכנה"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-700"}`,children:[e.jsx("div",{className:"text-2xl mb-2",children:"💻"}),e.jsx("div",{className:"font-semibold",children:"בקשת תוכנה"})]}),e.jsxs("button",{type:"button",onClick:()=>m("תגים"),className:`p-4 rounded-lg border-2 transition-colors ${a==="תגים"?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-gray-300 text-gray-700"}`,children:[e.jsx("div",{className:"text-2xl mb-2",children:"🏷️"}),e.jsx("div",{className:"font-semibold",children:"בקשת תגים"})]})]})]}),a&&e.jsxs("form",{onSubmit:y,className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:["טופס ",a==="SMS"?"בקשת SMS":a==="תוכנה"?"בקשת תוכנה":"בקשת תגים"]}),j(),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>{i(""),d({}),n(null),c(!1)},className:"px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",disabled:u,children:"ביטול"}),e.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors disabled:opacity-50",disabled:u,children:u?"יוצר טופס...":"צור טופס"})]})]})]})};export{w as default};
